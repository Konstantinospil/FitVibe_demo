{"chunk_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-009-global-exercise-library-ownership-model_chunk_000", "doc_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-009-global-exercise-library-ownership-model", "text": "# ADR-009 — Global Exercise Library Ownership Model\n\n> **File:** docs/adr/ADR-009-global-exercise-library-ownership-model.md  \n> **Purpose:** Balance a curated global exercise catalog with user customization and extension.\n\n---\n\nid: ADR-009\ntitle: \"Global Exercise Library Ownership Model\"\nstatus: \"Proposed\"\ndate: \"2025-10-13\"\nowners: [\"Dr. Konstantinos Pilpilidis\"]\nversion: \"1.0\"\nlinks:\n\n- TDD §4.3: \"Exercises module\"\n- TDD §6.2.6: \"Data modeling choices\"\n\n---\n\n\n## Context\n\nFitVibe ships a **global exercise library** (curated by admins) but must allow users to define custom exercises. We require a model that avoids naming conflicts, supports localization, and keeps admin updates from clobbering user customizations.\n\n## Decision\n\nUse **admin‑owned global records** where `owner_id IS NULL`. **User‑owned** exercises have `owner_id = <user_id>`. Enforce **normalized uniqueness**: `UNIQUE (lower(name), COALESCE(owner_id, '00000000-0000-0000-0000-000000000000'))`.", "source_file": "../../docs/2.Technical_Design_Document/2.f.Architectural_Decision_Documentation/ADR-009-global-exercise-library-ownership-model.md", "category": "technical", "chunk_index": 0, "token_count": 243, "hash_short": "5b90f337", "version": 1.0, "title": "ADR-009 — Global Exercise Library Ownership Model", "mtime": "2025-10-18T10:54:49.876878", "ingested_at": "2025-11-30T04:00:44.100155", "tags": ["technical", "md"]}
{"chunk_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-009-global-exercise-library-ownership-model_chunk_001", "doc_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-009-global-exercise-library-ownership-model", "text": "where `owner_id IS NULL`. **User‑owned** exercises have `owner_id = <user_id>`. Enforce **normalized uniqueness**: `UNIQUE (lower(name), COALESCE(owner_id, '00000000-0000-0000-0000-000000000000'))`.\n\n### Rules\n\n- Global exercises: created/edited by admins; visible to all.\n- Users may **fork** a global exercise to customize fields (name, cues, defaults). Forks become **user‑owned** records linked by `source_exercise_id`.\n- Lookup order: prefer **user‑owned** overrides; fall back to global.\n- De-duplication: app suggests globals when a user creates a similar (case/locale-insensitive) name.\n- Localization: names and cues stored in `exercise_translations` per locale; uniqueness applies to a **canonical slug**.\n\n### Data Model (key fields)\n\n- `exercises(id, owner_id NULLABLE, source_exercise_id NULLABLE, slug, primary_muscle, equipment, created_at, updated_at)`\n- Constraint for normalized uniqueness as above.\n\n## Consequences\n\n- Clean separation of curated vs. personal content.", "source_file": "../../docs/2.Technical_Design_Document/2.f.Architectural_Decision_Documentation/ADR-009-global-exercise-library-ownership-model.md", "category": "technical", "chunk_index": 1, "token_count": 246, "hash_short": "1743180e", "version": 1.0, "title": "ADR-009 — Global Exercise Library Ownership Model", "mtime": "2025-10-18T10:54:49.876878", "ingested_at": "2025-11-30T04:00:44.100155", "tags": ["technical", "md"]}
{"chunk_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-009-global-exercise-library-ownership-model_chunk_002", "doc_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-009-global-exercise-library-ownership-model", "text": "_exercise_id NULLABLE, slug, primary_muscle, equipment, created_at, updated_at)`\n- Constraint for normalized uniqueness as above.\n\n## Consequences\n\n- Clean separation of curated vs. personal content.\n- Admin updates do not override user customizations.\n- Slightly more complex lookups and uniqueness checks.\n\n## Alternatives Considered\n\n- **Single global set only**: Blocks personalization.\n- **Per-user only**: No shared catalog; duplicates proliferate.\n\n## QA & Acceptance\n\n- Tests for uniqueness across global/user scopes.\n- Forking keeps links; renames maintain uniqueness constraints.\n- Search returns user fork first if present.\n\n## Backout Plan\n\nIf forks add too much complexity, fallback to **global + per-user alias table** while keeping uniqueness on slugs.\n\n## Change Log\n\n- **1.0 (2025-10-13):** Initial proposal.", "source_file": "../../docs/2.Technical_Design_Document/2.f.Architectural_Decision_Documentation/ADR-009-global-exercise-library-ownership-model.md", "category": "technical", "chunk_index": 2, "token_count": 206, "hash_short": "16fad94d", "version": 1.0, "title": "ADR-009 — Global Exercise Library Ownership Model", "mtime": "2025-10-18T10:54:49.876878", "ingested_at": "2025-11-30T04:00:44.100155", "tags": ["technical", "md"]}
