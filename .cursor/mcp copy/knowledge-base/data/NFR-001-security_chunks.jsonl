{"chunk_id": ".._.._docs_1.Product_Requirements_a.Requirements_NFR-001-security_chunk_000", "doc_id": ".._.._docs_1.Product_Requirements_a.Requirements_NFR-001-security", "text": "# NFR-001 — Security\n\n---\n\n**Requirement ID**: NFR-001  \n**Type**: Non-Functional Requirement  \n**Title**: Security  \n**Status**: Done  \n**Priority**: High  \n**Gate**: GOLD  \n**Owner**: SEC/ENG  \n**Created**: 2025-11-21  \n**Updated**: 2025-01-21\n\n---\n\n\n## Executive Summary\n\nThis non-functional requirement defines security standards and constraints for the FitVibe platform.\n\nEnsure platform security through headers, rate limiting, and threat protection.\n\n## Business Context\n\n- **Business Objective**: Ensure platform security through headers, rate limiting, and threat protection.\n- **Success Criteria**: Security headers are properly configured, rate limiting prevents abuse, and threats are detected.", "source_file": "../../docs/1.Product_Requirements/a.Requirements/NFR-001-security.md", "category": "requirements", "chunk_index": 0, "token_count": 176, "hash_short": "06e16279", "version": 1.0, "title": "NFR-001 — Security", "mtime": "2025-11-30T03:53:28.214791", "ingested_at": "2025-11-30T04:00:44.213053", "tags": ["requirements", "md"]}
{"chunk_id": ".._.._docs_1.Product_Requirements_a.Requirements_NFR-001-security_chunk_001", "doc_id": ".._.._docs_1.Product_Requirements_a.Requirements_NFR-001-security", "text": "sure platform security through headers, rate limiting, and threat protection.\n- **Success Criteria**: Security headers are properly configured, rate limiting prevents abuse, and threats are detected.", "source_file": "../../docs/1.Product_Requirements/a.Requirements/NFR-001-security.md", "category": "requirements", "chunk_index": 1, "token_count": 49, "hash_short": "5ac0aa22", "version": 1.0, "title": "NFR-001 — Security", "mtime": "2025-11-30T03:53:28.214791", "ingested_at": "2025-11-30T04:00:44.213053", "tags": ["requirements", "md"]}
{"chunk_id": ".._.._docs_1.Product_Requirements_a.Requirements_NFR-001-security_chunk_002", "doc_id": ".._.._docs_1.Product_Requirements_a.Requirements_NFR-001-security", "text": "- **Target Users**: All users (security affects everyone)\n\n## Traceability\n\n- **PRD Reference**: PRD §Security\n- **TDD Reference**: TDD §Security\n\n## Non-Functional Requirements\n\n### Security Headers\n\nThe system shall implement comprehensive security headers:\n\n- **CSP**: Content Security Policy with no inline scripts/styles, nonce-based script-src\n- **HSTS**: HTTP Strict Transport Security with min-age ≥6 months\n- **Referrer-Policy**: Strict referrer policy\n- **Permissions-Policy**: Limits sensors and features\n- **Cookie Security**: HttpOnly, Secure, SameSite flags properly configured\n\n### Rate Limiting\n\n- **Auth Endpoints**: Rate limit `/auth/*` endpoints ≥10 req/min/IP\n- **429 Response**: Return 429 with Retry-After header when limit exceeded\n- **CAPTCHA**: CAPTCHA challenge after sustained abuse (>50 req/10min/IP) via feature flag\n\n### Token Security\n\n- **JWT Validation**: JWT claims validated (aud/iss/exp) with clock skew ≤30s\n- **Algorithm Pinning**: RS256 algorithm enforced\n- **Key Rotation**: Key rotation (kid) tested and supported", "source_file": "../../docs/1.Product_Requirements/a.Requirements/NFR-001-security.md", "category": "requirements", "chunk_index": 2, "token_count": 263, "hash_short": "657a141f", "version": 1.0, "title": "NFR-001 — Security", "mtime": "2025-11-30T03:53:28.214791", "ingested_at": "2025-11-30T04:00:44.213053", "tags": ["requirements", "md"]}
{"chunk_id": ".._.._docs_1.Product_Requirements_a.Requirements_NFR-001-security_chunk_003", "doc_id": ".._.._docs_1.Product_Requirements_a.Requirements_NFR-001-security", "text": "n Security\n\n- **JWT Validation**: JWT claims validated (aud/iss/exp) with clock skew ≤30s\n- **Algorithm Pinning**: RS256 algorithm enforced\n- **Key Rotation**: Key rotation (kid) tested and supported\n\n\n### File Upload Security\n\n- **Antivirus Scanning**: Upload AV scan rejects EICAR and quarantines infected files\n- **User-Safe Messages**: User-friendly error messages for rejected files\n\n## Related Epics\n\n- [E17: Security](../b.Epics/E17-security.md)\n\n## Dependencies\n\n### Technical Dependencies\n\n- Security header middleware\n- Rate limiting library\n- JWT library\n- Antivirus scanning service\n\n### Feature Dependencies\n\n- [FR-001: User Registration](./FR-001-user-registration.md) - User accounts\n- [FR-002: Login & Session](./FR-002-login-and-session.md) - Authentication\n- [FR-009: Profile & Settings](./FR-009-profile-and-settings.md) - File uploads\n\n## Constraints\n\n### Technical Constraints\n\n- CSP report-only mode for 7 days before enforcement\n- CSP violations ≤1% before enforcement\n- Rate limit: ≥10 req/min/IP for auth endpoints\n- Clock skew tolerance: ≤30s", "source_file": "../../docs/1.Product_Requirements/a.Requirements/NFR-001-security.md", "category": "requirements", "chunk_index": 3, "token_count": 267, "hash_short": "0a7afd46", "version": 1.0, "title": "NFR-001 — Security", "mtime": "2025-11-30T03:53:28.214791", "ingested_at": "2025-11-30T04:00:44.213053", "tags": ["requirements", "md"]}
{"chunk_id": ".._.._docs_1.Product_Requirements_a.Requirements_NFR-001-security_chunk_004", "doc_id": ".._.._docs_1.Product_Requirements_a.Requirements_NFR-001-security", "text": "s\n\n### Technical Constraints\n\n- CSP report-only mode for 7 days before enforcement\n- CSP violations ≤1% before enforcement\n- Rate limit: ≥10 req/min/IP for auth endpoints\n- Clock skew tolerance: ≤30s\n\n\n### Business Constraints\n\n- Security must not degrade user experience\n- CAPTCHA must be optional (feature flag)\n\n## Assumptions\n\n- Users understand security measures\n- Security headers are supported by browsers\n- Antivirus service is reliable\n\n## Risks & Issues\n\n- **Risk**: Security headers may break some functionality\n- **Risk**: Rate limiting may prevent legitimate access\n- **Risk**: CAPTCHA may frustrate users\n\n## Open Questions\n\n- Should there be different rate limits for different user types?\n- Should CAPTCHA be mandatory or optional?", "source_file": "../../docs/1.Product_Requirements/a.Requirements/NFR-001-security.md", "category": "requirements", "chunk_index": 4, "token_count": 186, "hash_short": "ea4eadd8", "version": 1.0, "title": "NFR-001 — Security", "mtime": "2025-11-30T03:53:28.214791", "ingested_at": "2025-11-30T04:00:44.213053", "tags": ["requirements", "md"]}
{"chunk_id": ".._.._docs_1.Product_Requirements_a.Requirements_NFR-001-security_chunk_005", "doc_id": ".._.._docs_1.Product_Requirements_a.Requirements_NFR-001-security", "text": "may prevent legitimate access\n- **Risk**: CAPTCHA may frustrate users\n\n## Open Questions\n\n- Should there be different rate limits for different user types?\n- Should CAPTCHA be mandatory or optional?\n\n## Related Requirements\n\n- [FR-001: User Registration](./FR-001-user-registration.md) - Registration security\n- [FR-002: Login & Session](./FR-002-login-and-session.md) - Authentication security\n- [FR-009: Profile & Settings](./FR-009-profile-and-settings.md) - File upload security\n\n---\n\n**Last Updated**: 2025-01-21  \n**Next Review**: 2025-02-21", "source_file": "../../docs/1.Product_Requirements/a.Requirements/NFR-001-security.md", "category": "requirements", "chunk_index": 5, "token_count": 136, "hash_short": "c8990b95", "version": 1.0, "title": "NFR-001 — Security", "mtime": "2025-11-30T03:53:28.214791", "ingested_at": "2025-11-30T04:00:44.213053", "tags": ["requirements", "md"]}
