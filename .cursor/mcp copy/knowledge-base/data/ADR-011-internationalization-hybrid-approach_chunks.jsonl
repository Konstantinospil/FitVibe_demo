{"chunk_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-011-internationalization-hybrid-approach_chunk_000", "doc_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-011-internationalization-hybrid-approach", "text": "# ADR-011: Internationalization – Hybrid Model with MVP Static-Only Rollout\n\n**Date:** 2025-10-14  \n**Status:** Accepted  \n**Author:** Reviewer  \n**Cross-References:** PRD §4 (FR-8) & §6.14 i18n/l10n; TDD §1.1, §1.2 (assumptions), §4.8, §5.5; QA §5.1 (AC-8.1…8.5), §11 (performance)\n\n---\n\n\n## Context\n\nThe PRD defines a hybrid i18n approach: all UI strings are statically translated (EN/DE), while user-generated content (UGC) may be translated dynamically via an external AI service with caching, privacy controls, and UX affordances (toggle/original).  \nThe TDD defers dynamic AI translation to Phase 2 while delivering static i18n in the MVP; it also mandates ADRs for cross-cutting decisions and RTM alignment.  \nQA formalizes acceptance: language auto-detect + manual switch; UI tokens must come from static catalogs with EN fallback; delete requests must purge related translation cache entries; and perf budgets apply (API p95 < 300 ms; AI translation ≤ 800 ms on cache miss when enabled).", "source_file": "../../docs/2.Technical_Design_Document/2.f.Architectural_Decision_Documentation/ADR-011-internationalization-hybrid-approach.md", "category": "technical", "chunk_index": 0, "token_count": 249, "hash_short": "3de3b6c0", "version": 1.0, "title": "ADR-011: Internationalization – Hybrid Model with MVP Static-Only Rollout", "mtime": "2025-10-18T10:54:49.899997", "ingested_at": "2025-11-30T04:00:44.110432", "tags": ["technical", "md"]}
{"chunk_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-011-internationalization-hybrid-approach_chunk_001", "doc_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-011-internationalization-hybrid-approach", "text": "me from static catalogs with EN fallback; delete requests must purge related translation cache entries; and perf budgets apply (API p95 < 300 ms; AI translation ≤ 800 ms on cache miss when enabled).\n\nGoal: lock a decision that reconciles PRD vision (hybrid) with TDD scope (MVP = static only), and is fully testable under the QA plan.\n\n---\n\n## Decision\n\n1. **Architecture (Hybrid-by-Design).**\n   - **Static UI i18n (MVP):** All UI strings come from token catalogs (EN/DE) with EN fallback; no runtime translation for UI. Enforcement via lint/checks and CI token coverage. (Meets QA AC-8.1/8.3/8.4.)\n   - **Dynamic UGC Translation (Feature-flagged, Phase 2):** A backend adapter (`translateText(lang, text)`) routes to a pluggable provider (OpenAI/DeepL), with caching and PII redaction before egress. When disabled, UGC renders in original language only. (Aligns PRD §6.14; deferred per TDD.)\n\n2.", "source_file": "../../docs/2.Technical_Design_Document/2.f.Architectural_Decision_Documentation/ADR-011-internationalization-hybrid-approach.md", "category": "technical", "chunk_index": 1, "token_count": 224, "hash_short": "6ac1d94a", "version": 1.0, "title": "ADR-011: Internationalization – Hybrid Model with MVP Static-Only Rollout", "mtime": "2025-10-18T10:54:49.899997", "ingested_at": "2025-11-30T04:00:44.110432", "tags": ["technical", "md"]}
{"chunk_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-011-internationalization-hybrid-approach_chunk_002", "doc_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-011-internationalization-hybrid-approach", "text": "g, text)`) routes to a pluggable provider (OpenAI/DeepL), with caching and PII redaction before egress. When disabled, UGC renders in original language only. (Aligns PRD §6.14; deferred per TDD.)\n\n2. **MVP Scope Switches (Defaults):**\n   - `FEATURE_UGC_AI_TRANSLATION=false` in prod/staging; `true` only in controlled test envs.\n   - Cache schema (`translation_cache`) and API surfaces are present but inert if the flag is off. (Keeps forward compatibility with PRD while honoring TDD’s deferral.)\n\n3. **Contracts & Budgets:**\n   - **Latency:** AI translate path target ≤ 800 ms p95 on cache miss; overall API budgets remain (p95 < 300 ms). If the feature flag is on, requests invoking translation must be async/queued when expected to exceed 800 ms, otherwise the UI shows original with “translated coming” toast.", "source_file": "../../docs/2.Technical_Design_Document/2.f.Architectural_Decision_Documentation/ADR-011-internationalization-hybrid-approach.md", "category": "technical", "chunk_index": 2, "token_count": 203, "hash_short": "b448ffb0", "version": 1.0, "title": "ADR-011: Internationalization – Hybrid Model with MVP Static-Only Rollout", "mtime": "2025-10-18T10:54:49.899997", "ingested_at": "2025-11-30T04:00:44.110432", "tags": ["technical", "md"]}
{"chunk_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-011-internationalization-hybrid-approach_chunk_003", "doc_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-011-internationalization-hybrid-approach", "text": "remain (p95 < 300 ms). If the feature flag is on, requests invoking translation must be async/queued when expected to exceed 800 ms, otherwise the UI shows original with “translated coming” toast.\n   - **Privacy:** PII redaction on all external translation calls; only anonymized text in cache; DSR delete purges cache entries linked to user content within ≤14 days per backup purge policy.\n   - **Accessibility:** `<html lang>` updated on switch; translation badge and “View original” affordance meet WCAG guidance. (QA a11y checks apply.)\n\n4. **Testability & Observability:**\n   - **Metrics:** `i18n_translation_requests_total{provider,hit}` and `i18n_translation_latency_ms` exported; alert if p95 > 800 ms sustained 10 min.\n   - **QA Hooks:** Playwright asserts token coverage, language persistence, and cache-purge on DSR. k6 smoke includes translated feed route when flag is enabled.", "source_file": "../../docs/2.Technical_Design_Document/2.f.Architectural_Decision_Documentation/ADR-011-internationalization-hybrid-approach.md", "category": "technical", "chunk_index": 3, "token_count": 222, "hash_short": "09f4b93a", "version": 1.0, "title": "ADR-011: Internationalization – Hybrid Model with MVP Static-Only Rollout", "mtime": "2025-10-18T10:54:49.899997", "ingested_at": "2025-11-30T04:00:44.110432", "tags": ["technical", "md"]}
{"chunk_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-011-internationalization-hybrid-approach_chunk_004", "doc_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-011-internationalization-hybrid-approach", "text": "rt if p95 > 800 ms sustained 10 min.\n   - **QA Hooks:** Playwright asserts token coverage, language persistence, and cache-purge on DSR. k6 smoke includes translated feed route when flag is enabled.\n\n---\n\n## Consequences\n\n**Positive**\n\n- Unblocks MVP with static i18n now, while keeping clean seams for Phase-2 dynamic UGC translation (no refactor tax).\n- Aligns with PRD vision but respects TDD scope via feature flag governance and CI gates.\n- Clear QA coverage (AC-8.1…8.5) and performance/observability budgets.\n\n**Negative / Trade-offs**\n\n- Carrying dormant code paths (adapter/cache) adds small maintenance and security surface; mitigated by feature flag = off and CI checks.\n- Translation quality/cost risks are deferred, requiring a Phase-2 rollout plan and provider evaluation.\n\n**Operational**\n\n- Feature flag defaults verified in CI/CD; prod config must pin `FEATURE_UGC_AI_TRANSLATION=false`. Rollouts require canary + metrics SLO watch.", "source_file": "../../docs/2.Technical_Design_Document/2.f.Architectural_Decision_Documentation/ADR-011-internationalization-hybrid-approach.md", "category": "technical", "chunk_index": 4, "token_count": 237, "hash_short": "bdba9200", "version": 1.0, "title": "ADR-011: Internationalization – Hybrid Model with MVP Static-Only Rollout", "mtime": "2025-10-18T10:54:49.899997", "ingested_at": "2025-11-30T04:00:44.110432", "tags": ["technical", "md"]}
{"chunk_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-011-internationalization-hybrid-approach_chunk_005", "doc_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-011-internationalization-hybrid-approach", "text": "llout plan and provider evaluation.\n\n**Operational**\n\n- Feature flag defaults verified in CI/CD; prod config must pin `FEATURE_UGC_AI_TRANSLATION=false`. Rollouts require canary + metrics SLO watch.\n\n---\n\n## Alternatives Considered\n\n| Option                         | Description                                          | Reason Rejected                                                                  |\n| ------------------------------ | ---------------------------------------------------- | -------------------------------------------------------------------------------- |\n| Static-only i18n (drop hybrid) | Ship only token catalogs; no UGC translation at all. | Conflicts with PRD’s hybrid direction and global UX goals.                       |\n| Enable AI translation in MVP   | Turn on UGC translation immediately.                 | Contradicts TDD MVP assumption; adds cost & perf risk before QA infra is proven.", "source_file": "../../docs/2.Technical_Design_Document/2.f.Architectural_Decision_Documentation/ADR-011-internationalization-hybrid-approach.md", "category": "technical", "chunk_index": 5, "token_count": 230, "hash_short": "49c0997e", "version": 1.0, "title": "ADR-011: Internationalization – Hybrid Model with MVP Static-Only Rollout", "mtime": "2025-10-18T10:54:49.899997", "ingested_at": "2025-11-30T04:00:44.110432", "tags": ["technical", "md"]}
{"chunk_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-011-internationalization-hybrid-approach_chunk_006", "doc_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-011-internationalization-hybrid-approach", "text": "als.                       |\n| Enable AI translation in MVP   | Turn on UGC translation immediately.                 | Contradicts TDD MVP assumption; adds cost & perf risk before QA infra is proven. |\n| Client-side translation        | Perform translation in the browser via JS SDK.       | Violates privacy model (PII control) and complicates caching/observability.      |\n\n---\n\n## References\n\n- ADR template & ADR governance (TDD §15.1.1): required headers, links, status lifecycle.\n- PRD – i18n Hybrid (FR-8, §6.14): static UI + dynamic UGC translation, caching, privacy.\n- TDD – Scope & Assumptions: MVP = static i18n; dynamic UGC translation explicitly Phase 2.\n- QA Plan – AC-8.x, Perf gates: token catalogs, EN fallback, DSR cache purge; API p95 < 300 ms; AI path ≤ 800 ms when enabled.", "source_file": "../../docs/2.Technical_Design_Document/2.f.Architectural_Decision_Documentation/ADR-011-internationalization-hybrid-approach.md", "category": "technical", "chunk_index": 6, "token_count": 198, "hash_short": "a84294cd", "version": 1.0, "title": "ADR-011: Internationalization – Hybrid Model with MVP Static-Only Rollout", "mtime": "2025-10-18T10:54:49.899997", "ingested_at": "2025-11-30T04:00:44.110432", "tags": ["technical", "md"]}
{"chunk_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-011-internationalization-hybrid-approach_chunk_007", "doc_id": ".._.._docs_2.Technical_Design_Document_2.f.Architectural_Decision_Documentation_ADR-011-internationalization-hybrid-approach", "text": "mptions: MVP = static i18n; dynamic UGC translation explicitly Phase 2.\n- QA Plan – AC-8.x, Perf gates: token catalogs, EN fallback, DSR cache purge; API p95 < 300 ms; AI path ≤ 800 ms when enabled.\n\n---\n\n## Status Log\n\n| Version | Date       | Change                                                                     | Author   |\n| ------- | ---------- | -------------------------------------------------------------------------- | -------- |\n| v1.0    | 2025-10-14 | Initial rewrite with MVP static rollout + Phase-2 flag for UGC translation | Reviewer |", "source_file": "../../docs/2.Technical_Design_Document/2.f.Architectural_Decision_Documentation/ADR-011-internationalization-hybrid-approach.md", "category": "technical", "chunk_index": 7, "token_count": 139, "hash_short": "f7a879f9", "version": 1.0, "title": "ADR-011: Internationalization – Hybrid Model with MVP Static-Only Rollout", "mtime": "2025-10-18T10:54:49.899997", "ingested_at": "2025-11-30T04:00:44.110432", "tags": ["technical", "md"]}
