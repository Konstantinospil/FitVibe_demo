{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_000", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "﻿---\ntitle: \"FitVibe — Testing & Quality Assurance Plan\"\nversion: \"v3.0\"\nstatus: \"Approved (MVP → GA baseline)\"\nreview_cadence: \"Per release and quarterly\"\ndate: \"2025-10-26\"\nlicense: \"MIT\"\n---\n\n# 1. Purpose & Scope\n\nThis plan defines **how FitVibe verifies, validates, and continuously assures quality** across the product lifecycle, aligning with the PRD, TDD, and VDD. It is both a **policy** (what must be true to ship) and a **playbook** (how we test, measure, and gate releases).\n\n**Scope:** Frontend SPA, Backend/API & DB schema, Infrastructure & CI/CD, Observability, Security/Privacy & Compliance, Backup/DR.\n**Out of scope (MVP):** Real-time collaboration, wearables integrations, advanced notifications (covered in future increments with addenda).\n\n---\n\n# 2.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 0, "token_count": 192, "hash_short": "b3456c92", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_001", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "lity, Security/Privacy & Compliance, Backup/DR.\n**Out of scope (MVP):** Real-time collaboration, wearables integrations, advanced notifications (covered in future increments with addenda).\n\n---\n\n# 2. Quality Objectives (Targets & Gates)\n\n| Objective                      | Target / Gate                                                                                                     | Evidence                                    |\n| ------------------------------ | ----------------------------------------------------------------------------------------------------------------- | ------------------------------------------- |\n| Functional correctness         | 100% pass for **Register → Verify → Login → Plan → Complete → Analytics Export**                                  | Playwright E2E report + traces              |\n| Test coverage                  | **≥80% lines & branches** repo-wide; **≥90%** on auth/session/points critical code                                | Coverage HTML + thresholds in CI            |\n| API performance (p95 by group) | auth ≤200 ms · crud ≤300 ms · feed ≤400 ms · analytics ≤600 ms; ≤10% regression                                   |\n| Cold start                     | /health returns 200 in ≤5 s from container start                                                                  |\n| Request/Response sizes         | Request body ≤2 MB; Response body ≤1 MB; gzip/Brotli for >1 KB                                                    |\n| Telemetry hygiene              | No PII in logs/metrics/labels (lint & sample scan)                                                                |\n| Web performance                | LCP P75 < 2.5 s (mid-tier 4G device); ≤5 API calls on first paint (key screens)                                   | Lighthouse CI + Playwright network          |\n| Accessibility                  | WCAG 2.1 AA, axe/Lighthouse score **≥90** (Auth, Planner, Logger, Dashboard)                                      | a11y JSON & screenshot notes                |\n| Security & Supply chain        | **0 High/Critical** SCA; ZAP baseline **no High**; SBOM per build; images **signed (cosign)**; **pinned digests** | SCA/ZAP reports, SBOM, signature verify log |\n| Privacy & GDPR                 | DSR export/delete **≤30 days**; delete propagates to backups **≤14 days** (evidence)                              | DSR records + DR drill report               |\n| Availability                   | SLO ≥99.5% monthly (error budget ≤0.5%)                                                                           | SLO dashboard                               |\n| Visual integrity               | **Tokens contract** passes; **visual diff ≤0.2%** on critical pages (light/dark · xs/sm/md/lg)                    | Visual snapshot diffs                       |\n\n**Baseline artifact:** The measurement snapshot lives in `tests/qa/baseline/qa_plan_v2.0.json` (validated by `tests/qa/assert-baseline.js`)", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 1, "token_count": 738, "hash_short": "57fd4e48", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_002", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "| Visual snapshot diffs                       |\n\n**Baseline artifact:** The measurement snapshot lives in `tests/qa/baseline/qa_plan_v2.0.json` (validated by `tests/qa/assert-baseline.js`).\n\n**Policy:** Any gate failure blocks PR merge and/or release. Waivers must include **ID, rationale, expiry, and approver** (PO + Tech Lead + QA Lead).\n\n---\n\n# 3. Governance & Roles\n\n| Role                 | Responsibilities                                                                       |\n| -------------------- | -------------------------------------------------------------------------------------- |\n| **QA Lead**          | Owns this plan, curates RTM, defines CI gates, tracks flakiness, approves waivers.     |\n| **Tech Lead**        | Ensures testability hooks; reviews reliability budgets; co-owns perf & security gates. |\n| **Product Owner**    | Validates acceptance criteria; signs UAT; manages risk & scope trade-offs.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 2, "token_count": 231, "hash_short": "3e4e227f", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_003", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "nsures testability hooks; reviews reliability budgets; co-owns perf & security gates. |\n| **Product Owner**    | Validates acceptance criteria; signs UAT; manages risk & scope trade-offs.             |\n| **Design**           | Maintains VDD & tokens; reviews visual baseline updates; approves visual diffs.        |\n| **Security/Privacy** | Approves security scans and GDPR evidence; audits headers/TLS/DSR artifacts.           |\n| **Engineers**        | Ship features with tests; keep fixtures deterministic; fix flaky tests promptly.       |\n\n**Review cadence:** per release (PRD delta + RTM sync) and quarterly (coverage, perf trend, escaped defects).\n\n---\n\n# 4. Definitions & Abbreviations\n\n**AC** (Acceptance Criteria), **RTM** (Requirements Traceability Matrix), **DSR** (Data Subject Request), **RPO/RTO** (Recovery Point/Time Objective), **SBOM**, **LCP**, **SLO**, **WCAG**.\n\n---\n\n# 5.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 3, "token_count": 223, "hash_short": "a23a4749", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_004", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "**AC** (Acceptance Criteria), **RTM** (Requirements Traceability Matrix), **DSR** (Data Subject Request), **RPO/RTO** (Recovery Point/Time Objective), **SBOM**, **LCP**, **SLO**, **WCAG**.\n\n---\n\n# 5. Requirements Traceability (RTM)\n\nWe maintain a living RTM at `docs/rtm_comprehensive.csv`, mapping **PRD FR/NFR → AC IDs → Test IDs/paths → Evidence artifacts**.\nThe **AC master** lives in `docs/qa/AC_Master.md` (reviewed with PRD updates). CI checks ensure referenced tests exist and are green.\n\n---\n\n# 6. Risk-Based Strategy\n\nWe prioritize test depth based on **likelihood × impact** (auth flows, session completion, feed privacy, analytics aggregation). High-risk areas receive **redundant coverage** (unit + integration + E2E + contract + security/perf where applicable).\n\n---\n\n# 7. Test Architecture & Determinism\n\n- **Unit:** Jest/Vitest; fakes for clock/UUID; seeded PRNG; golden responses for some helpers.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 4, "token_count": 228, "hash_short": "f8feccc9", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_005", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "egration + E2E + contract + security/perf where applicable).\n\n---\n\n# 7. Test Architecture & Determinism\n\n- **Unit:** Jest/Vitest; fakes for clock/UUID; seeded PRNG; golden responses for some helpers.\n- **Integration:** Supertest against API with **ephemeral Postgres**; migrations applied; transactional tests; object storage & mail fakes; AV fake (EICAR positive).\n- **Contract:** zod ↔ OpenAPI schema parity; negative assertions (no leakage of scoring internals).\n- **E2E:** Playwright across Chromium/WebKit/Firefox; stable data seeds; **FakeClock**; masked dynamic regions in snapshots.\n- **Data migrations:** order/drift/index/FK/enum contracts; reproducible seeds.\n- **Observability:** metrics contract tests; trace coverage spot-checks.\n\n---\n\n# 7.1 Test Reliability & Flake Management\n\n## 7.1.1 Flaky Test Definition\n\nA test is **flaky** if it produces inconsistent results (pass/fail) on the same code commit without deterministic cause.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 5, "token_count": 236, "hash_short": "5db2de63", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_006", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "-\n\n# 7.1 Test Reliability & Flake Management\n\n## 7.1.1 Flaky Test Definition\n\nA test is **flaky** if it produces inconsistent results (pass/fail) on the same code commit without deterministic cause.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 6, "token_count": 49, "hash_short": "e22d0a08", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_007", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "**Trigger conditions:**\n\n- Fails ≥1 time in 50 runs on same commit SHA\n- Requires >1 retry to pass in Playwright/Jest\n- Timing-dependent (race conditions, hardcoded sleeps)\n\n## 7.1.2 Test Reliability SLI/SLO\n\n**SLI (Service Level Indicator):**\n\n```\nFlake Rate = (Flaky Test Runs / Total Test Runs) × 100\n```\n\n**Measurement window:** Rolling 7 days\n\n**SLO (Service Level Objective):**\n\n- **Target:** Flake rate ≤ **2%** repo-wide\n- **Critical paths (auth, sessions, checkout):** ≤ **1%**\n\n**Tracking:**\n\n- Playwright: `reporter: ['json', { outputFile: 'reports/test-results.json' }]`\n- Parse retry counts from JSON; aggregate to dashboard\n\n## 7.1.3 Flake Detection & Quarantine\n\n**Automated detection (CI):**\n\n```js\n// scripts/ci/detect-flakes.mjs\nimport results from \"../reports/test-results.json\";\n\nconst flakes = results.suites\n  .flatMap((s) => s.specs)\n  .filter((spec) => spec.tests.some((t) => t.results.length > 1)); // Retried\n\nif (flakes.length > 0) {\n  console.warn(`⚠️  Detected ${flakes.length} flaky tests:`);\n  flakes.forEach((f) => console.warn(`  - ${f.file}:${f.line} \"${f.title}\"`));\n\n  // Auto-create issue if ≥3 flakes in 7 days\n  // (GitHub API call with label: 'flaky-test')\n}\n```\n\n**Quarantine process:**\n\n1", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 7, "token_count": 307, "hash_short": "0460eece", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_008", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "s.forEach((f) => console.warn(`  - ${f.file}:${f.line} \"${f.title}\"`));\n\n  // Auto-create issue if ≥3 flakes in 7 days\n  // (GitHub API call with label: 'flaky-test')\n}\n```\n\n**Quarantine process:**\n\n1. **Trigger:** Test flakes 3× in 7 days\n2. **Action:**\n   - Auto-skip with `test.skip` + `@flaky` annotation\n   - GitHub issue created with:\n     - Trace links (last 3 failures)\n     - Suspected root cause (timing, network, seed data)\n     - Owner assignment (test file author)\n3. **SLA:** Fix or delete within **1 sprint** (2 weeks)\n4.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 8, "token_count": 134, "hash_short": "65efa4d1", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_009", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "th:\n     - Trace links (last 3 failures)\n     - Suspected root cause (timing, network, seed data)\n     - Owner assignment (test file author)\n3. **SLA:** Fix or delete within **1 sprint** (2 weeks)\n4. **Escalation:** If unresolved after 1 sprint, test is **deleted** (not disabled)\n\n## 7.1.4 Root Cause Categories & Mitigations\n\n| Category            | Symptoms                          | Mitigation                                                        |\n| ------------------- | --------------------------------- | ----------------------------------------------------------------- |\n| **Timing**          | `waitForSelector` timeouts        | Use `waitForLoadState('networkidle')`; increase timeout sparingly |\n| **Network**         | Flaky API mocks                   | MSW strict mode; assert route handlers called                     |\n| **Seed data**       | Unique constraint violations      | Transactional cleanup; deterministic UUIDs                        |\n| **Animation**       | Screenshot pixel diffs            | Disable animations in test; mask dynamic regions                  |\n| **Race conditions** | Intermittent DB constraint errors | Use transactions; serialize writes; idempotency                   |\n| **Env-specific**    | Passes locally, fails CI          | Reproduce with Docker; check font/timezone/deps                   |", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 9, "token_count": 337, "hash_short": "abc8bd39", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_010", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "s | Use transactions; serialize writes; idempotency                   |\n| **Env-specific**    | Passes locally, fails CI          | Reproduce with Docker; check font/timezone/deps                   |\n\n\n## 7.1.5 Reporting & Review\n\n**Weekly flake report (auto-generated):**\n\n- Top 10 flakiest tests (by retry count)\n- Flake rate trend (7d/30d)\n- Quarantined tests status (age, owner, issue link)\n\n**Quarterly review (QA Lead):**\n\n- Flake rate vs SLO\n- Patterns: Which suites/frameworks are flakiest?\n- Action items: Refactor problematic test patterns\n\n## 7.1.6 Playwright Retries Configuration\n\n```ts\n// playwright.config.ts\nexport default defineConfig({\n  retries: process.env.CI ? 2 : 0, // Retry twice on CI only\n  reporter: [\n    [\"list\"],\n    [\"json\", { outputFile: \"reports/test-results.json\" }],\n    [\"html\", { open: \"never\" }],\n  ],\n});\n```\n\n**Policy:** Retries are a **crutch**, not a solution. Any test requiring >1 retry to pass must be investigated.\n\n---\n\n# 8.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 10, "token_count": 242, "hash_short": "ae1e1210", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_011", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "eports/test-results.json\" }],\n    [\"html\", { open: \"never\" }],\n  ],\n});\n```\n\n**Policy:** Retries are a **crutch**, not a solution. Any test requiring >1 retry to pass must be investigated.\n\n---\n\n# 8. Test Levels (What & How)\n\n## 8.1 Functional\n\n- **Auth & Security:** email verify (TTL 15m, resend ≤3/h), lockout after 10 tries, 2FA TOTP + backup codes, refresh rotation & reuse detection, **no user enumeration**.\n- **Profiles:** alias uniqueness (case-insensitive), avatar upload (≤5 MB, EXIF stripped, AV scan).\n- **Exercise Library:** RBAC (admins manage global), soft delete & audit trail, search indexes (GIN/trigram).\n- **Sessions:** lifecycle & cloning with attribution, RRULE DST-safe, public↔private sync to feed ≤5 min.\n- **Analytics:** matview refresh on completion; CSV/JSON export; range guards (413).\n- **Points & Badges:** non-negative bounded scoring; on-complete awarding; no formula exposure.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 11, "token_count": 227, "hash_short": "ab93480c", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_012", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "nc to feed ≤5 min.\n- **Analytics:** matview refresh on completion; CSV/JSON export; range guards (413).\n- **Points & Badges:** non-negative bounded scoring; on-complete awarding; no formula exposure.\n- **Sharing & Feed:** default privacy = private; discoverability controlled by flags; link token lifecycle.\n- **i18n:** static token catalogs (EN/DE); fallback EN; lint prevents stray literals; manual language switch persists.\n\n## 8.2 Non-Functional\n\n- **Performance:** grouped k6 scenarios (auth/CRUD/feed/analytics); thresholds & regression guard; response size ≤1 MB; gzip/Brotli required; key dashboards ≤600 ms p95 on CI dataset.\n- **Accessibility:** axe/Lighthouse ≥90; keyboard nav; focus ring; contrast AA; consent banner blocks non-essential analytics until opt-in.\n- **Security:** SCA (npm/OSV), ZAP baseline (auth ctx), headers (CSP, HSTS, Referrer-Policy, Permissions-Policy), CSRF/CORS, secrets scan, rate-limit/lockout abuse scenarios.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 12, "token_count": 237, "hash_short": "f4c15a12", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_013", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "analytics until opt-in.\n- **Security:** SCA (npm/OSV), ZAP baseline (auth ctx), headers (CSP, HSTS, Referrer-Policy, Permissions-Policy), CSRF/CORS, secrets scan, rate-limit/lockout abuse scenarios.\n- **Supply chain:** SBOM (Syft), image scan (Trivy/Grype), **cosign sign + verify**, **pinned digest** deploys.\n- **Visual design:** token contract (CSS variables & `tokens.json`), visual regression snapshots (light/dark; xs/sm/md/lg); responsive overflow guards; reduced-motion parity.\n- **Observability:** `/metrics` exposes `{method,route,status_code}` histograms, DB query histogram, RUM LCP gauge; trace spans for API handlers with DB child spans.\n\n---\n\n## 8.2.1 Performance Baseline Management\n\n### Purpose\n\nPrevent false positives from regression guard while allowing legitimate performance changes (new features, intentional trade-offs).", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 13, "token_count": 211, "hash_short": "7c521e39", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_014", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "pans.\n\n---\n\n## 8.2.1 Performance Baseline Management\n\n### Purpose\n\nPrevent false positives from regression guard while allowing legitimate performance changes (new features, intentional trade-offs).\n\n### Baseline Storage\n\n**Location:** `tests/perf/baselines/{branch}.json`\n\n**Structure:**\n\n```json\n{\n  \"version\": \"1.0\",\n  \"commit\": \"abc123def\",\n  \"date\": \"2025-10-26T10:00:00Z\",\n  \"groups\": {\n    \"auth\": { \"p50\": 145, \"p95\": 198, \"p99\": 250 },\n    \"crud\": { \"p50\": 210, \"p95\": 295, \"p99\": 380 },\n    \"feed\": { \"p50\": 310, \"p95\": 395, \"p99\": 510 },\n    \"analytics\": { \"p50\": 450, \"p95\": 590, \"p99\": 750 }\n  },\n  \"infrastructure\": {\n    \"runner\": \"GitHub Actions ubuntu-latest\",\n    \"cpu\": \"2 cores\",\n    \"memory\": \"7GB\",\n    \"db\": \"PostgreSQL 16.2 (shared)\"\n  }\n}\n```\n\n### Update Process\n\n**Scenario 1: Intentional Performance Change**\n\n1.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 14, "token_count": 209, "hash_short": "e6c1157a", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_015", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "ner\": \"GitHub Actions ubuntu-latest\",\n    \"cpu\": \"2 cores\",\n    \"memory\": \"7GB\",\n    \"db\": \"PostgreSQL 16.2 (shared)\"\n  }\n}\n```\n\n### Update Process\n\n**Scenario 1: Intentional Performance Change**\n\n1. Engineer proposes new baseline in PR description:\n\n```markdown\n## Performance Impact\n\n- **Change:** Added session aggregation caching\n- **Expected:** Analytics p95 improves 200ms → 150ms\n- **Justification:** Issue #1234 (analytics too slow)\n```\n\n2. k6 runs; comparison report attached:\n\n```\n   Group      | Old p95 | New p95 | Δ      | Status\n   -----------|---------|---------|--------|--------\n   analytics  | 590ms   | 420ms   | -29%   | ✅ Improvement\n```\n\n3. **Approval required:** Tech Lead + PO (if regression) or Tech Lead only (if improvement)\n\n4. **Merge:** Baseline auto-updates on merge to `main`\n\n**Scenario 2: Infrastructure Change**\n\n- CI runner upgrade, DB version change, etc.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 15, "token_count": 223, "hash_short": "5ec6b97e", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_016", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "ad + PO (if regression) or Tech Lead only (if improvement)\n\n4. **Merge:** Baseline auto-updates on merge to `main`\n\n**Scenario 2: Infrastructure Change**\n\n- CI runner upgrade, DB version change, etc.\n- **Action:** Regenerate all baselines with annotation in commit:\n\n```\n  perf: Regenerate baselines for GitHub Actions ubuntu-22.04\n\n  Infrastructure change: ubuntu-20.04 → 22.04\n  No application code changes.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 16, "token_count": 102, "hash_short": "d087e4a7", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_017", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": ":** Regenerate all baselines with annotation in commit:\n\n```\n  perf: Regenerate baselines for GitHub Actions ubuntu-22.04\n\n  Infrastructure change: ubuntu-20.04 → 22.04\n  No application code changes.\n```\n\n**Scenario 3: Fluke/Transient Degradation**\n\n- Single PR shows regression but no code changes justify it\n- **Action:** Re-run k6 3× on same commit; take median p95\n- If regression persists → investigate (CI resource contention, DB query plan change)\n- If regression clears → noise; no baseline update\n\n### Automated Baseline Update (Post-Merge)\n\n```yaml\n# .github/workflows/update-perf-baseline.yml\nname: Update Performance Baseline\non:\n  push:\n    branches: [main]\n    paths: [\"apps/**\", \"packages/**\"] # Only on app changes\n\njobs:\n  update_baseline:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: grafana/setup-k6@v1\n      - run: k6 run tests/perf/k6/budgets.js --out json=reports/perf-new.json\n      - name: Update baseline (if 3 consecutive greens)\n        run: node scripts/perf/update-baseline.mjs reports/perf-new.json\n        # Logic: Only update if last 3 main runs were green\n      - uses: stefanzweifel/git-auto-commit-action@v5\n        with:\n          commit_message: \"perf: Auto-update baseline [skip ci]\"\n          file_pattern: tests/perf/baselines/main.json\n```", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 17, "token_count": 330, "hash_short": "af576f8e", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_018", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "e green\n      - uses: stefanzweifel/git-auto-commit-action@v5\n        with:\n          commit_message: \"perf: Auto-update baseline [skip ci]\"\n          file_pattern: tests/perf/baselines/main.json\n```\n\n\n### Regression Guard Logic\n\n```js\n// tests/perf/k6/assert-budgets.mjs\nconst baseline = JSON.parse(fs.readFileSync(\"tests/perf/baselines/main.json\"));\nconst current = parseK6Results(\"reports/perf.json\");\n\nfor (const group of [\"auth\", \"crud\", \"feed\", \"analytics\"]) {\n  const oldP95 = baseline.groups[group].p95;\n  const newP95 = current.groups[group].p95;\n  const delta = ((newP95 - oldP95) / oldP95) * 100;\n\n  if (delta > 10) {\n    // 10% regression threshold\n    console.error(`❌ ${group} p95 regressed ${delta.toFixed(1)}% (${oldP95}ms → ${newP95}ms)`);\n    process.exit(1);\n  }\n\n  console.log(`✅ ${group} p95: ${newP95}ms (Δ ${delta > 0 ?", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 18, "token_count": 210, "hash_short": "39dd9c39", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_019", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "ression threshold\n    console.error(`❌ ${group} p95 regressed ${delta.toFixed(1)}% (${oldP95}ms → ${newP95}ms)`);\n    process.exit(1);\n  }\n\n  console.log(`✅ ${group} p95: ${newP95}ms (Δ ${delta > 0 ? \"+\" : \"\"}${delta.toFixed(1)}%)`);\n}\n```\n\n### Normalization (CI Runner Variance)\n\n**Problem:** GitHub Actions runners vary in performance (~15% variance)\n\n**Solution:**\n\n1. Run k6 **3 times** per CI job\n2. Discard highest and lowest p95\n3. Use **median** p95 for comparison\n\n```js\nconst runs = [runK6(), runK6(), runK6()];\nconst p95s = runs.map((r) => r.groups.auth.p95).sort((a, b) => a - b);\nconst medianP95 = p95s[1]; // Middle value\n```\n\n### Quarterly Review\n\n**QA Lead + Tech Lead + DevOps:**\n\n- Compare baseline drift over time\n- Correlate with infrastructure changes, traffic growth\n- Adjust budgets if SLO targets shift (e.g., analytics now <500ms instead of <600ms)\n\n# 9.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 19, "token_count": 219, "hash_short": "7977f53f", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_020", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "Lead + DevOps:**\n\n- Compare baseline drift over time\n- Correlate with infrastructure changes, traffic growth\n- Adjust budgets if SLO targets shift (e.g., analytics now <500ms instead of <600ms)\n\n# 9. Test Environments & Data\n\n| Env                | Purpose                 | Data                    | Branch/Gate     |\n| ------------------ | ----------------------- | ----------------------- | --------------- |\n| **Local**          | Dev loop                | Synthetic seeds & fakes | none            |\n| **CI (ephemeral)** | Automated checks        | Migrated DB + seeds     | PR gate         |\n| **Staging**        | UAT, perf/a11y/security | Anonymized/synthetic    | main protected  |\n| **Production**     | Live                    | Real                    | tag + approvals |\n\n**Data policy:** Non-PII in CI; scoped SAs; ephemerals destroyed post-run.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 20, "token_count": 214, "hash_short": "fe911509", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_021", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "thetic    | main protected  |\n| **Production**     | Live                    | Real                    | tag + approvals |\n\n**Data policy:** Non-PII in CI; scoped SAs; ephemerals destroyed post-run.\n\n---\n\n## 9.1 Test Data Strategy\n\n### 9.1.1 Synthetic Data Generation\n\n**Framework:** Faker.js with deterministic seeds per test suite\n\n**Factory pattern (`tests/fixtures/factories/`):**\n\n```ts// user.factory.ts\nimport { faker } from '@faker-js/faker';export function createUser(seed: number, overrides = {}) {\nfaker.seed(seed);\nreturn {\nid: faker.string.uuid(),\nemail: faker.internet.email(),\nalias: faker.internet.userName(),\ndateOfBirth: '1990-01-01',\ngender: 'prefer_not_to_say',\nrole: 'user',\ncreatedAt: faker.date.past(),\n...overrides\n};\n}// session.factory.ts\nexport function createSession(userId: string, seed: number, overrides = {}) {\nfaker.seed(seed);\nreturn {\nid: faker.string.uuid(),\nuserId,\ntitle: faker.company.catchPhrase(),\nscheduledAt: faker.date.future(),\nstatus: 'planned',\nprivacy: 'private',\n...overrides\n};\n}\n```", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 21, "token_count": 258, "hash_short": "01376fd1", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_022", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "= {}) {\nfaker.seed(seed);\nreturn {\nid: faker.string.uuid(),\nuserId,\ntitle: faker.company.catchPhrase(),\nscheduledAt: faker.date.future(),\nstatus: 'planned',\nprivacy: 'private',\n...overrides\n};\n}\n```\n\n\n### 9.1.2 Referential Integrity\n\n**Constraint:** All foreign keys must reference existing parent records\n\n**Approach:**\n\n1. Generate parent entities first (users, exercises)\n2. Child factories accept parent IDs as required params\n3.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 22, "token_count": 108, "hash_short": "0ec4295b", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_023", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "**Constraint:** All foreign keys must reference existing parent records\n\n**Approach:**\n\n1. Generate parent entities first (users, exercises)\n2. Child factories accept parent IDs as required params\n3. Transactional test setup ensures cleanup\n\n**Example test setup:**\n\n```tsdescribe('Session completion', () => {\nlet user, exercise, session;beforeEach(async () => {\nuser = await db.users.create(createUser(12345));\nexercise = await db.exercises.create(createExercise(67890));\nsession = await db.sessions.create(createSession(user.id, 11111, {\nexercises: [{ exerciseId: exercise.id, sets: 3 }]\n}));\n});afterEach(async () => {\nawait db.$transaction([\ndb.sessions.deleteMany(),\ndb.exercises.deleteMany(),\ndb.users.deleteMany()\n]);\n});\n});\n```\n\n### 9.1.3 Seed Versioning & Lineage\n\n**Storage:** `tests/fixtures/seeds/v{major}.{minor}/`\n\n**Structure:**tests/fixtures/seeds/\n├─ v1.0/\n│ ├─ users.json # 10 synthetic users\n│ ├─ exercises.json # 50 exercises (5 global admin, 45 user-owned)\n│ ├─ sessions.json # 100 sessions (varied statuses)\n│ └─ manifest.json # checksums, counts, relationships\n├─ v1.1/ # Added points/badges data\n│ ├─ users.json\n│ ├─ exercises.json\n│ ├─ sessions.json\n│ ├─ points.json # NEW\n│ └─ manifest.json\n└─ current -> v1.1/ # Symlink to active version\n\n**Versioning policy:**\n\n- **Patch (x.y.Z):** Quantity changes only (more users/sessions)\n- **Minor (x.Y.0):** New entity types added (points, badges)\n- **Major (X.0.0):** Breaking schema changes (column removals)\n\n**CI usage:**\n`bashpnpm db:seed:load tests/fixtures/seeds/current/`", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 23, "token_count": 387, "hash_short": "1efc32a1", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_024", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "sions)\n- **Minor (x.Y.0):** New entity types added (points, badges)\n- **Major (X.0.0):** Breaking schema changes (column removals)\n\n**CI usage:**\n`bashpnpm db:seed:load tests/fixtures/seeds/current/`\n\n\n### 9.1.4 Anonymization (Staging)\n\n**When:** Staging requires prod-like scale for perf testing\n\n**Process:**\n\n1. Export production schema + row counts\n2. Apply anonymization transforms:\n\n````sqlUPDATE users SET\nemail = 'user_' || id || '@example.test',\nalias = 'user_' || id,\navatar_url = NULL,\nphone = NULL;UPDATE sessions SET\nnotes = CASE\nWHEN notes IS NOT NULL THEN 'Anonymized training notes'\nELSE NULL\nEND;```\n3. Validate: no real emails/phones remain (regex scan)\n4. Export to staging dump\n\n**Frequency:** Monthly or on-demand for perf testing\n\n### 9.1.5 Refresh Cadence & Drift Detection\n\n**Quarterly review (QA Lead + BE Lead):**\n1. Compare seed schema vs current DB schema\n2. Identify missing columns, new constraints, enum changes\n3.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 24, "token_count": 236, "hash_short": "42ce5cd4", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_025", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "sting\n\n### 9.1.5 Refresh Cadence & Drift Detection\n\n**Quarterly review (QA Lead + BE Lead):**\n1. Compare seed schema vs current DB schema\n2. Identify missing columns, new constraints, enum changes\n3. Regenerate seeds if drift detected\n\n**Automated drift detection (CI):**\n```ts// tests/db/seed-drift.test.ts\nimport { db } from './client';\nimport manifest from '../fixtures/seeds/current/manifest.json';test('Seed data matches current schema', async () => {\nconst tableInfo = await db.$queryRaw    SELECT column_name, data_type, is_nullable     FROM information_schema.columns     WHERE table_name = 'users'  ;const seedSchema = manifest.tables.users.columns;\nexpect(tableInfo).toMatchObject(seedSchema); // Deep equality\n});```\n\n**Action on drift:** Fail CI with message: \"Seed data outdated.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 25, "token_count": 198, "hash_short": "21dcd9c0", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_026", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "ame = 'users'  ;const seedSchema = manifest.tables.users.columns;\nexpect(tableInfo).toMatchObject(seedSchema); // Deep equality\n});```\n\n**Action on drift:** Fail CI with message: \"Seed data outdated. Run `pnpm db:seed:regenerate`\"\n\n### 9.1.6 Environment Parity Matrix\n\n| Component        | Local | CI    | Staging | Prod  |\n|-----------------|-------|-------|---------|-------|\n| DB Version      | 16.2  | 16.2  | 16.2    | 16.2  |\n| Node Version    | 20    | 20    | 20      | 20    |\n| Seed Version    | v1.1  | v1.1  | Anon    | Real  |\n| Feature Flags   | All   | Prod  | Prod    | Prod  |\n| Observability   | Mock  | Real  | Real    | Real  |\n| Object Storage  | Fake  | Fake  | Real    | Real  |\n| Email/SMS       | Fake  | Fake  | Sandbox | Prod  |\n\n**Gate:** CI fails if local/CI parity breaks (Node version mismatch, etc.)\n---\n\n# 10. Tooling\n\n- **Unit/Integration:** Jest/Vitest, Supertest, MSW.\n- **E2E/Visual:** Playwright (`toHaveScreenshot()`; masked regions).\n- **Performance:** k6 (TS)", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 26, "token_count": 250, "hash_short": "76dfc08d", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_027", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "s (Node version mismatch, etc.)\n---\n\n# 10. Tooling\n\n- **Unit/Integration:** Jest/Vitest, Supertest, MSW.\n- **E2E/Visual:** Playwright (`toHaveScreenshot()`; masked regions).\n- **Performance:** k6 (TS).\n- **Accessibility:** axe-core, Lighthouse CI.\n- **Contracts:** zod ↔ OpenAPI, Spectral lints; DB contracts (custom scripts).\n- **Security:** npm audit/OSV, ZAP, Trivy/Grype, git-secrets.\n- **Observability:** Prometheus scrape tests; trace smoke.\n- **Coverage:** Istanbul; thresholds enforced.\n- **Reporting:** Markdown templates & Node generator (optional), Codecov, GH Summary.\n\n---\n\n# 11. CI/CD Integration & Quality Gates\n\n**Order (parallelized where sensible):**\n\n1. Lint + Typecheck\n2. Unit + Integration (coverage enforced)\n3. Contract (OpenAPI & DB contracts)\n4. E2E (Playwright + traces)\n5. Accessibility (axe/Lighthouse)\n6. Performance (k6) with regression guard\n7. Security (SCA + ZAP baseline)\n8. Observability (metrics contract)\n9.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 27, "token_count": 236, "hash_short": "d3641df8", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_028", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "penAPI & DB contracts)\n4. E2E (Playwright + traces)\n5. Accessibility (axe/Lighthouse)\n6. Performance (k6) with regression guard\n7. Security (SCA + ZAP baseline)\n8. Observability (metrics contract)\n9. Packaging: SBOM, sign (cosign), **verify signatures**, enforce **pinned digests**\n10. Deploy to **staging** → release safety smoke → **UAT sign-off** → **production**\n\n**Blocking gates:** any threshold breach, any unapproved visual diff, any contrast/token violation, SCA/ZAP high, metrics contract failure.\n\nArtifacts are retained (≥14–30 days): coverage HTML, Playwright traces, Lighthouse/axe/k6 JSON, ZAP HTML, SBOM, signatures, metrics snapshots, visual diffs.\n\n---\n\n# 12. UAT & Release Management\n\n- **UAT scripts:**\n  1. Register→Verify→Login→Plan (next week)→Start/Complete (today)→Dashboard→Export CSV\n  2. Privacy/i18n: deny analytics → switch to DE → reload tokens → delete account → ensure export link disabled after delete\n  3.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 28, "token_count": 235, "hash_short": "4c1b18a1", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_029", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "fy→Login→Plan (next week)→Start/Complete (today)→Dashboard→Export CSV\n  2. Privacy/i18n: deny analytics → switch to DE → reload tokens → delete account → ensure export link disabled after delete\n  3. Sharing: publish a session → open link in private window → revoke → verify 404\n\n- **Sign-off:** PO + Tech Lead + QA Lead.\n- **Waivers:** documented with expiry and mitigation; link to issues/PRs.\n\n---\n\n# 13. Defect Management\n\n**Severity:** S1 (critical outage/data loss) ≤24h; S2 ≤3d; S3 ≤7d; S4 next sprint.\n**Workflow:** New → Triaged → In-Progress → QA Verify → Done.\n**RCA:** mandatory for S1/S2; add tests/monitors; ADR if architectural.\n\n---\n\n# 14. Reporting & Evidence\n\n- **Per-PR:** GH summary + Codecov delta + failing suites list.\n- **Per-pipeline:** CI Test Run report (totals, suites, failures, links to artifacts).\n- **Per-release:** QA Summary with gates, waivers, defects, risks, and UAT sign-off.\n- **Compliance bundles:** DSR evidence; DR drill (RPO/RTO + **erasure-replay**).", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 29, "token_count": 248, "hash_short": "847870f8", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_030", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": ", failures, links to artifacts).\n- **Per-release:** QA Summary with gates, waivers, defects, risks, and UAT sign-off.\n- **Compliance bundles:** DSR evidence; DR drill (RPO/RTO + **erasure-replay**).\n\n_(Templates available under `/reports/templates/` if you adopt the generator script.)_\n\n---\n\n# 15. Backup & DR Validation\n\n- **Quarterly restore drill** demonstrating **RPO ≤24h**, **RTO ≤4h**, and **erasure-replay** (proof that DSR delete propagates to backups ≤14 days).\n- Evidence: selected backup timestamp, restore duration, data currency, replay logs, sign-off.\n\n---\n\n# 16. Visual Design QA (Detailed)\n\n- **Tokens contract (VIZ-TOK-03):**\n  - Assert presence of required CSS variables (`--color-*`, spacing, radii, typography scale).\n  - Deny ad-hoc overrides in app code (lint rule / CI script).\n- **Snapshots (VIZ-SNAP-02):**\n  - Critical screens: Auth, Planner, Logger, Dashboard.\n  - Themes: **light/dark**; Breakpoints: **xs, sm, md, lg**.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 30, "token_count": 237, "hash_short": "083a74bb", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_031", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "oc overrides in app code (lint rule / CI script).\n- **Snapshots (VIZ-SNAP-02):**\n  - Critical screens: Auth, Planner, Logger, Dashboard.\n  - Themes: **light/dark**; Breakpoints: **xs, sm, md, lg**.\n  - Mask timestamps/avatars/charts; seeded clock & data; diff ≤0.2%.\n- **Contrast & A11y (VIZ-CNT-04 / A11Y-CORE-01):**\n  - WCAG AA (body ≥4.5:1; large text ≥3:1).\n- **Responsive guards (VIZ-RESP-05):**\n  - No horizontal overflow; grid alignment; long-DE strings tested.\n- **Reduced motion (VIZ-MOTION-09):**\n  - Honors `prefers-reduced-motion`; no essential info by animation only.\n\n**Gate:** any unapproved snapshot diff or token/contrast violation blocks merge.\n\n---\n\n# 17. Observability & Operability Tests (Detailed)\n\n- **Metrics contract:**\n  - HTTP histogram/counters with labels `{method, route, status_code}`\n  - DB query histogram `db_query_duration_ms` (p50/p95)\n  - RUM `frontend_lcp_ms` gauge\n- **Trace checks:** handler spans include DB child spans; sampling documented.", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 31, "token_count": 245, "hash_short": "89f77ea9", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
{"chunk_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan_chunk_032", "doc_id": ".._.._docs_4.Testing_and_Quality_Assurance_Plan_4a.Testing_and_Quality_Assurance_Plan", "text": "s `{method, route, status_code}`\n  - DB query histogram `db_query_duration_ms` (p50/p95)\n  - RUM `frontend_lcp_ms` gauge\n- **Trace checks:** handler spans include DB child spans; sampling documented.\n- **SLOs:** alert rules for error budget consumption; dashboard snapshot archived per release.\n````", "source_file": "../../docs/4.Testing_and_Quality_Assurance_Plan/4a.Testing_and_Quality_Assurance_Plan.md", "category": "testing", "chunk_index": 32, "token_count": 74, "hash_short": "62e91725", "version": 1.0, "title": "1. Purpose & Scope", "mtime": "2025-11-11T20:00:51.686143", "ingested_at": "2025-11-30T04:00:43.787522", "tags": ["testing", "md"]}
